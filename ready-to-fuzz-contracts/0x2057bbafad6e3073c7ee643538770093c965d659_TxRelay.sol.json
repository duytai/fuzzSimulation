{"name":"TxRelay","address":"0x2057bbafad6e3073c7ee643538770093c965d659","source":"pragma solidity ^0.4.24;\r\n\r\n// This contract is heavily inspired by uPort from https://github.com/uport-project/uport-identity/blob/develop/contracts/TxRelay.sol\r\ncontract TxRelay {\r\n\r\n    // Note: This is a local nonce.\r\n    // Different from the nonce defined w/in protocol.\r\n    mapping(address => uint) public nonce;\r\n\r\n    // This is for debug purpose\r\n    event Log(address from, string message);\r\n    event MetaTxRelayed(address indexed claimedSender, address indexed addressFromSig);\r\n\r\n    /*\r\n     * @dev Relays meta transactions\r\n     * @param sigV, sigR, sigS ECDSA signature on some data to be forwarded\r\n     * @param destination Location the meta-tx should be forwarded to\r\n     * @param data The bytes necessary to call the function in the destination contract.\r\n     */\r\n    function relayMetaTx(\r\n        uint8 sigV,\r\n        bytes32 sigR,\r\n        bytes32 sigS,\r\n        address destination,\r\n        bytes data\r\n    ) public {\r\n\r\n        address claimedSender = getAddressFromData(data);\r\n        // use EIP 191\r\n        // 0x19 :: version :: relay :: sender :: nonce :: destination :: data\r\n        bytes32 h = keccak256(\r\n            abi.encodePacked(byte(0x19), byte(0), this, claimedSender, nonce[claimedSender], destination, data)\r\n        );\r\n        address addressFromSig = getAddressFromSig(h, sigV, sigR, sigS);\r\n\r\n        // address recovered from signature must match with claimed sender\r\n        require(claimedSender == addressFromSig, \"address recovered from signature must match with claimed sender\");\r\n\r\n        //if we are going to do tx, update nonce\r\n        nonce[claimedSender]++;\r\n\r\n        // invoke method on behalf of sender\r\n        require(destination.call(data), \"can not invoke destination function\");\r\n\r\n        emit MetaTxRelayed(claimedSender, addressFromSig);\r\n    }\r\n\r\n    /*\r\n     * @dev Gets an address encoded as the first argument in transaction data\r\n     * @param b The byte array that should have an address as first argument\r\n     * @returns a The address retrieved from the array\r\n     (Optimization based on work by tjade273)\r\n     */\r\n    function getAddressFromData(bytes b) public pure returns (address a) {\r\n        if (b.length < 36) return address(0);\r\n        assembly {\r\n            let mask := 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\r\n            a := and(mask, mload(add(b, 36)))\r\n            // 36 is the offset of the first parameter of the data, if encoded properly.\r\n            // 32 bytes for the length of the bytes array, and 4 bytes for the function signature.\r\n        }\r\n    }\r\n\r\n    /*\r\n     * @dev Gets an address from msgHash and signature\r\n     * @param msgHash EIP 191\r\n     * @param sigV, sigR, sigS ECDSA signature on some data to be forwarded\r\n     * @returns a The address retrieved\r\n     */\r\n    function getAddressFromSig(\r\n        bytes32 msgHash,\r\n        uint8 sigV,\r\n        bytes32 sigR,\r\n        bytes32 sigS\r\n    ) public pure returns (address a) {\r\n        return ecrecover(msgHash, sigV, sigR, sigS);\r\n    }\r\n}","contract":{"abi":"[{\"constant\":true,\"inputs\":[{\"name\":\"msgHash\",\"type\":\"bytes32\"},{\"name\":\"sigV\",\"type\":\"uint8\"},{\"name\":\"sigR\",\"type\":\"bytes32\"},{\"name\":\"sigS\",\"type\":\"bytes32\"}],\"name\":\"getAddressFromSig\",\"outputs\":[{\"name\":\"a\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"nonce\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"sigV\",\"type\":\"uint8\"},{\"name\":\"sigR\",\"type\":\"bytes32\"},{\"name\":\"sigS\",\"type\":\"bytes32\"},{\"name\":\"destination\",\"type\":\"address\"},{\"name\":\"data\",\"type\":\"bytes\"}],\"name\":\"relayMetaTx\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"b\",\"type\":\"bytes\"}],\"name\":\"getAddressFromData\",\"outputs\":[{\"name\":\"a\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"message\",\"type\":\"string\"}],\"name\":\"Log\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"claimedSender\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"addressFromSig\",\"type\":\"address\"}],\"name\":\"MetaTxRelayed\",\"type\":\"event\"}]","bin":"608060405234801561001057600080fd5b50610936806100206000396000f300608060405260043610610062576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063153fe5831461006757806370ae92d214610101578063b4fadcad14610158578063f5cb3dff1461020a575b600080fd5b34801561007357600080fd5b506100bf6004803603810190808035600019169060200190929190803560ff169060200190929190803560001916906020019092919080356000191690602001909291905050506102b3565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561010d57600080fd5b50610142600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610340565b6040518082815260200191505060405180910390f35b34801561016457600080fd5b50610208600480360381019080803560ff16906020019092919080356000191690602001909291908035600019169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610358565b005b34801561021657600080fd5b50610271600480360381019080803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192905050506108d0565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6000600185858585604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af115801561032c573d6000803e3d6000fd5b505050602060405103519050949350505050565b60006020528060005260406000206000915090505481565b6000806000610366846108d0565b925060197f01000000000000000000000000000000000000000000000000000000000000000260007f01000000000000000000000000000000000000000000000000000000000000000230856000808873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054898960405160200180887effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152600101877effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526001018673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c0100000000000000000000000002815260140182805190602001908083835b6020831015156105885780518252602082019150602081019050602083039250610563565b6001836020036101000a0380198251168184511680821785525050505050509050019750505050505050506040516020818303038152906040526040518082805190602001908083835b6020831015156105f757805182526020820191506020810190506020830392506105d2565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209150610632828989896102b3565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161415156106fd576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252603f8152602001807f61646472657373207265636f76657265642066726f6d207369676e617475726581526020017f206d757374206d61746368207769746820636c61696d65642073656e6465720081525060400191505060405180910390fd5b6000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600081548092919060010191905055508473ffffffffffffffffffffffffffffffffffffffff168460405180828051906020019080838360005b83811015610790578082015181840152602081019050610775565b50505050905090810190601f1680156107bd5780820380516001836020036101000a031916815260200191505b509150506000604051808303816000865af1915050151561086c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260238152602001807f63616e206e6f7420696e766f6b652064657374696e6174696f6e2066756e637481526020017f696f6e000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f820d364b40e7499068da4bc3ef8f0943ed5c55ad9c7708405c4cadcb7a85637f60405160405180910390a35050505050505050565b60006024825110156108e55760009050610905565b73ffffffffffffffffffffffffffffffffffffffff602483015181169150505b9190505600a165627a7a723058207494be64715cdce2ca08e13f5404f107fd2aad318cb85029cd9ac40f571d76e40029","bin-runtime":"608060405260043610610062576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063153fe5831461006757806370ae92d214610101578063b4fadcad14610158578063f5cb3dff1461020a575b600080fd5b34801561007357600080fd5b506100bf6004803603810190808035600019169060200190929190803560ff169060200190929190803560001916906020019092919080356000191690602001909291905050506102b3565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34801561010d57600080fd5b50610142600480360381019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610340565b6040518082815260200191505060405180910390f35b34801561016457600080fd5b50610208600480360381019080803560ff16906020019092919080356000191690602001909291908035600019169060200190929190803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509192919290505050610358565b005b34801561021657600080fd5b50610271600480360381019080803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091929192905050506108d0565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b6000600185858585604051600081526020016040526040518085600019166000191681526020018460ff1660ff1681526020018360001916600019168152602001826000191660001916815260200194505050505060206040516020810390808403906000865af115801561032c573d6000803e3d6000fd5b505050602060405103519050949350505050565b60006020528060005260406000206000915090505481565b6000806000610366846108d0565b925060197f01000000000000000000000000000000000000000000000000000000000000000260007f01000000000000000000000000000000000000000000000000000000000000000230856000808873ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054898960405160200180887effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152600101877effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681526001018673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c010000000000000000000000000281526014018481526020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166c0100000000000000000000000002815260140182805190602001908083835b6020831015156105885780518252602082019150602081019050602083039250610563565b6001836020036101000a0380198251168184511680821785525050505050509050019750505050505050506040516020818303038152906040526040518082805190602001908083835b6020831015156105f757805182526020820191506020810190506020830392506105d2565b6001836020036101000a03801982511681845116808217855250505050505090500191505060405180910390209150610632828989896102b3565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff161415156106fd576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252603f8152602001807f61646472657373207265636f76657265642066726f6d207369676e617475726581526020017f206d757374206d61746368207769746820636c61696d65642073656e6465720081525060400191505060405180910390fd5b6000808473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600081548092919060010191905055508473ffffffffffffffffffffffffffffffffffffffff168460405180828051906020019080838360005b83811015610790578082015181840152602081019050610775565b50505050905090810190601f1680156107bd5780820380516001836020036101000a031916815260200191505b509150506000604051808303816000865af1915050151561086c576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260238152602001807f63616e206e6f7420696e766f6b652064657374696e6174696f6e2066756e637481526020017f696f6e000000000000000000000000000000000000000000000000000000000081525060400191505060405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f820d364b40e7499068da4bc3ef8f0943ed5c55ad9c7708405c4cadcb7a85637f60405160405180910390a35050505050505050565b60006024825110156108e55760009050610905565b73ffffffffffffffffffffffffffffffffffffffff602483015181169150505b9190505600a165627a7a723058207494be64715cdce2ca08e13f5404f107fd2aad318cb85029cd9ac40f571d76e40029","srcmap":"163:2856:0:-;;;;8:9:-1;5:2;;;30:1;27;20:12;5:2;163:2856:0;;;;;;;","srcmap-runtime":"163:2856:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2795:221;;8:9:-1;5:2;;;30:1;27;20:12;5:2;2795:221:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;282:37;;8:9:-1;5:2;;;30:1;27;20:12;5:2;282:37:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;792:1028;;8:9:-1;5:2;;;30:1;27;20:12;5:2;792:1028:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2105:460;;8:9:-1;5:2;;;30:1;27;20:12;5:2;2105:460:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;2795:221;2943:9;2972:36;2982:7;2991:4;2997;3003;2972:36;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;8:9:-1;5:2;;;45:16;42:1;39;24:38;77:16;74:1;67:27;5:2;2972:36:0;;;;;;;;2965:43;;2795:221;;;;;;:::o;282:37::-;;;;;;;;;;;;;;;;;:::o;792:1028::-;958:21;1120:9;1277:22;982:24;1001:4;982:18;:24::i;:::-;958:48;;1178:4;1173:10;;1190:1;1185:7;;1194:4;1200:13;1215:5;:20;1221:13;1215:20;;;;;;;;;;;;;;;;1237:11;1250:4;1156:99;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;36:153:-1;66:2;61:3;58:11;51:19;36:153;;;182:3;176:10;171:3;164:23;98:2;93:3;89:12;82:19;;123:2;118:3;114:12;107:19;;148:2;143:3;139:12;132:19;;36:153;;;274:1;267:3;263:2;259:12;254:3;250:22;246:30;315:4;311:9;305:3;299:10;295:26;356:4;350:3;344:10;340:21;389:7;380;377:20;372:3;365:33;3:399;;;1156:99:0;;;;;;;;;;;;;;;;;49:4:-1;39:7;30;26:21;22:32;13:7;6:49;1156:99:0;;;1132:134;;;;;;;;;;;;;36:153:-1;66:2;61:3;58:11;51:19;36:153;;;182:3;176:10;171:3;164:23;98:2;93:3;89:12;82:19;;123:2;118:3;114:12;107:19;;148:2;143:3;139:12;132:19;;36:153;;;274:1;267:3;263:2;259:12;254:3;250:22;246:30;315:4;311:9;305:3;299:10;295:26;356:4;350:3;344:10;340:21;389:7;380;377:20;372:3;365:33;3:399;;;1132:134:0;;;;;;;;;;;;;;;;1120:146;;1302:38;1320:1;1323:4;1329;1335;1302:17;:38::i;:::-;1277:63;;1454:14;1437:31;;:13;:31;;;1429:107;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1599:5;:20;1605:13;1599:20;;;;;;;;;;;;;;;;:22;;;;;;;;;;;;;1688:11;:16;;1705:4;1688:22;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:10;8:100;;;99:1;94:3;90:11;84:18;80:1;75:3;71:11;64:39;52:2;49:1;45:10;40:15;;8:100;;;12:14;1688:22:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1680:70;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1797:14;1768:44;;1782:13;1768:44;;;;;;;;;;;;792:1028;;;;;;;;:::o;2105:460::-;2163:9;2200:2;2189:1;:8;:13;2185:36;;;2219:1;2204:17;;;;2185:36;2268:42;2352:2;2349:1;2345:10;2339:17;2333:4;2329:28;2324:33;;2241:317;;;;;:::o"},"ast":{"attributes":{"absolutePath":"/home/worm/Etherscan/downloader/tmp/0x2057bbafad6e3073c7ee643538770093c965d659_TxRelay.sol","exportedSymbols":{"TxRelay":[132]}},"children":[{"attributes":{"literals":["solidity","^","0.4",".24"]},"id":1,"name":"PragmaDirective","src":"0:24:0"},{"attributes":{"baseContracts":[null],"contractDependencies":[null],"contractKind":"contract","documentation":null,"fullyImplemented":true,"linearizedBaseContracts":[132],"name":"TxRelay","scope":133},"children":[{"attributes":{"constant":false,"name":"nonce","scope":132,"stateVariable":true,"storageLocation":"default","type":"mapping(address => uint256)","value":null,"visibility":"public"},"children":[{"attributes":{"type":"mapping(address => uint256)"},"children":[{"attributes":{"name":"address","type":"address"},"id":2,"name":"ElementaryTypeName","src":"290:7:0"},{"attributes":{"name":"uint","type":"uint256"},"id":3,"name":"ElementaryTypeName","src":"301:4:0"}],"id":4,"name":"Mapping","src":"282:24:0"}],"id":5,"name":"VariableDeclaration","src":"282:37:0"},{"attributes":{"anonymous":false,"documentation":null,"name":"Log"},"children":[{"children":[{"attributes":{"constant":false,"indexed":false,"name":"from","scope":11,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":6,"name":"ElementaryTypeName","src":"372:7:0"}],"id":7,"name":"VariableDeclaration","src":"372:12:0"},{"attributes":{"constant":false,"indexed":false,"name":"message","scope":11,"stateVariable":false,"storageLocation":"default","type":"string","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"string","type":"string"},"id":8,"name":"ElementaryTypeName","src":"386:6:0"}],"id":9,"name":"VariableDeclaration","src":"386:14:0"}],"id":10,"name":"ParameterList","src":"371:30:0"}],"id":11,"name":"EventDefinition","src":"362:40:0"},{"attributes":{"anonymous":false,"documentation":null,"name":"MetaTxRelayed"},"children":[{"children":[{"attributes":{"constant":false,"indexed":true,"name":"claimedSender","scope":17,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":12,"name":"ElementaryTypeName","src":"428:7:0"}],"id":13,"name":"VariableDeclaration","src":"428:29:0"},{"attributes":{"constant":false,"indexed":true,"name":"addressFromSig","scope":17,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":14,"name":"ElementaryTypeName","src":"459:7:0"}],"id":15,"name":"VariableDeclaration","src":"459:30:0"}],"id":16,"name":"ParameterList","src":"427:63:0"}],"id":17,"name":"EventDefinition","src":"408:83:0"},{"attributes":{"constant":false,"documentation":null,"implemented":true,"isConstructor":false,"modifiers":[null],"name":"relayMetaTx","payable":false,"scope":132,"stateMutability":"nonpayable","superFunction":null,"visibility":"public"},"children":[{"children":[{"attributes":{"constant":false,"name":"sigV","scope":92,"stateVariable":false,"storageLocation":"default","type":"uint8","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"uint8","type":"uint8"},"id":18,"name":"ElementaryTypeName","src":"823:5:0"}],"id":19,"name":"VariableDeclaration","src":"823:10:0"},{"attributes":{"constant":false,"name":"sigR","scope":92,"stateVariable":false,"storageLocation":"default","type":"bytes32","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes32","type":"bytes32"},"id":20,"name":"ElementaryTypeName","src":"844:7:0"}],"id":21,"name":"VariableDeclaration","src":"844:12:0"},{"attributes":{"constant":false,"name":"sigS","scope":92,"stateVariable":false,"storageLocation":"default","type":"bytes32","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes32","type":"bytes32"},"id":22,"name":"ElementaryTypeName","src":"867:7:0"}],"id":23,"name":"VariableDeclaration","src":"867:12:0"},{"attributes":{"constant":false,"name":"destination","scope":92,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":24,"name":"ElementaryTypeName","src":"890:7:0"}],"id":25,"name":"VariableDeclaration","src":"890:19:0"},{"attributes":{"constant":false,"name":"data","scope":92,"stateVariable":false,"storageLocation":"default","type":"bytes","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes","type":"bytes"},"id":26,"name":"ElementaryTypeName","src":"920:5:0"}],"id":27,"name":"VariableDeclaration","src":"920:10:0"}],"id":28,"name":"ParameterList","src":"812:125:0"},{"attributes":{"parameters":[null]},"children":[],"id":29,"name":"ParameterList","src":"945:0:0"},{"children":[{"attributes":{"assignments":[31]},"children":[{"attributes":{"constant":false,"name":"claimedSender","scope":92,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":30,"name":"ElementaryTypeName","src":"958:7:0"}],"id":31,"name":"VariableDeclaration","src":"958:21:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"address","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"overloadedDeclarations":[null],"referencedDeclaration":110,"type":"function (bytes memory) pure returns (address)","value":"getAddressFromData"},"id":32,"name":"Identifier","src":"982:18:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":27,"type":"bytes memory","value":"data"},"id":33,"name":"Identifier","src":"1001:4:0"}],"id":34,"name":"FunctionCall","src":"982:24:0"}],"id":35,"name":"VariableDeclarationStatement","src":"958:48:0"},{"attributes":{"assignments":[37]},"children":[{"attributes":{"constant":false,"name":"h","scope":92,"stateVariable":false,"storageLocation":"default","type":"bytes32","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes32","type":"bytes32"},"id":36,"name":"ElementaryTypeName","src":"1120:7:0"}],"id":37,"name":"VariableDeclaration","src":"1120:9:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"bytes32","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"overloadedDeclarations":[null],"referencedDeclaration":141,"type":"function () pure returns (bytes32)","value":"keccak256"},"id":38,"name":"Identifier","src":"1132:9:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"bytes memory","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bytes1","typeString":"bytes1"},{"typeIdentifier":"t_bytes1","typeString":"bytes1"},{"typeIdentifier":"t_contract$_TxRelay_$132","typeString":"contract TxRelay"},{"typeIdentifier":"t_address","typeString":"address"},{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_address","typeString":"address"},{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"member_name":"encodePacked","referencedDeclaration":null,"type":"function () pure returns (bytes memory)"},"children":[{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":134,"type":"abi","value":"abi"},"id":39,"name":"Identifier","src":"1156:3:0"}],"id":40,"name":"MemberAccess","src":"1156:16:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":true,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"bytes1","type_conversion":true},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_rational_25_by_1","typeString":"int_const 25"}],"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"type":"type(bytes1)","value":"byte"},"id":41,"name":"ElementaryTypeNameExpression","src":"1173:4:0"},{"attributes":{"argumentTypes":null,"hexvalue":"30783139","isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"subdenomination":null,"token":"number","type":"int_const 25","value":"0x19"},"id":42,"name":"Literal","src":"1178:4:0"}],"id":43,"name":"FunctionCall","src":"1173:10:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":true,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"bytes1","type_conversion":true},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"}],"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"type":"type(bytes1)","value":"byte"},"id":44,"name":"ElementaryTypeNameExpression","src":"1185:4:0"},{"attributes":{"argumentTypes":null,"hexvalue":"30","isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"subdenomination":null,"token":"number","type":"int_const 0","value":"0"},"id":45,"name":"Literal","src":"1190:1:0"}],"id":46,"name":"FunctionCall","src":"1185:7:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":160,"type":"contract TxRelay","value":"this"},"id":47,"name":"Identifier","src":"1194:4:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":31,"type":"address","value":"claimedSender"},"id":48,"name":"Identifier","src":"1200:13:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":false,"type":"uint256"},"children":[{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":5,"type":"mapping(address => uint256)","value":"nonce"},"id":49,"name":"Identifier","src":"1215:5:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":31,"type":"address","value":"claimedSender"},"id":50,"name":"Identifier","src":"1221:13:0"}],"id":51,"name":"IndexAccess","src":"1215:20:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":25,"type":"address","value":"destination"},"id":52,"name":"Identifier","src":"1237:11:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":27,"type":"bytes memory","value":"data"},"id":53,"name":"Identifier","src":"1250:4:0"}],"id":54,"name":"FunctionCall","src":"1156:99:0"}],"id":55,"name":"FunctionCall","src":"1132:134:0"}],"id":56,"name":"VariableDeclarationStatement","src":"1120:146:0"},{"attributes":{"assignments":[58]},"children":[{"attributes":{"constant":false,"name":"addressFromSig","scope":92,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":57,"name":"ElementaryTypeName","src":"1277:7:0"}],"id":58,"name":"VariableDeclaration","src":"1277:22:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"address","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bytes32","typeString":"bytes32"},{"typeIdentifier":"t_uint8","typeString":"uint8"},{"typeIdentifier":"t_bytes32","typeString":"bytes32"},{"typeIdentifier":"t_bytes32","typeString":"bytes32"}],"overloadedDeclarations":[null],"referencedDeclaration":131,"type":"function (bytes32,uint8,bytes32,bytes32) pure returns (address)","value":"getAddressFromSig"},"id":59,"name":"Identifier","src":"1302:17:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":37,"type":"bytes32","value":"h"},"id":60,"name":"Identifier","src":"1320:1:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":19,"type":"uint8","value":"sigV"},"id":61,"name":"Identifier","src":"1323:4:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":21,"type":"bytes32","value":"sigR"},"id":62,"name":"Identifier","src":"1329:4:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":23,"type":"bytes32","value":"sigS"},"id":63,"name":"Identifier","src":"1335:4:0"}],"id":64,"name":"FunctionCall","src":"1302:38:0"}],"id":65,"name":"VariableDeclarationStatement","src":"1277:63:0"},{"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"tuple()","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_81bd82111e19ef4cfe8d48ad8c515c248b4a6f6856df30c90b8100fcef57d556","typeString":"literal_string \"address recovered from signature must match with claimed sender\""}],"overloadedDeclarations":[150,151],"referencedDeclaration":151,"type":"function (bool,string memory) pure","value":"require"},"id":66,"name":"Identifier","src":"1429:7:0"},{"attributes":{"argumentTypes":null,"commonType":{"typeIdentifier":"t_address","typeString":"address"},"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"operator":"==","type":"bool"},"children":[{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":31,"type":"address","value":"claimedSender"},"id":67,"name":"Identifier","src":"1437:13:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":58,"type":"address","value":"addressFromSig"},"id":68,"name":"Identifier","src":"1454:14:0"}],"id":69,"name":"BinaryOperation","src":"1437:31:0"},{"attributes":{"argumentTypes":null,"hexvalue":"61646472657373207265636f76657265642066726f6d207369676e6174757265206d757374206d61746368207769746820636c61696d65642073656e646572","isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"subdenomination":null,"token":"string","type":"literal_string \"address recovered from signature must match with claimed sender\"","value":"address recovered from signature must match with claimed sender"},"id":70,"name":"Literal","src":"1470:65:0"}],"id":71,"name":"FunctionCall","src":"1429:107:0"}],"id":72,"name":"ExpressionStatement","src":"1429:107:0"},{"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"operator":"++","prefix":false,"type":"uint256"},"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":true,"isPure":false,"lValueRequested":true,"type":"uint256"},"children":[{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":5,"type":"mapping(address => uint256)","value":"nonce"},"id":73,"name":"Identifier","src":"1599:5:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":31,"type":"address","value":"claimedSender"},"id":74,"name":"Identifier","src":"1605:13:0"}],"id":75,"name":"IndexAccess","src":"1599:20:0"}],"id":76,"name":"UnaryOperation","src":"1599:22:0"}],"id":77,"name":"ExpressionStatement","src":"1599:22:0"},{"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"tuple()","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bool","typeString":"bool"},{"typeIdentifier":"t_stringliteral_225c71782fbabf4f5b066350fb7b2e23f406325311c0f5a939306c63d70690f6","typeString":"literal_string \"can not invoke destination function\""}],"overloadedDeclarations":[150,151],"referencedDeclaration":151,"type":"function (bool,string memory) pure","value":"require"},"id":78,"name":"Identifier","src":"1680:7:0"},{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"bool","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bytes_memory_ptr","typeString":"bytes memory"}],"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"member_name":"call","referencedDeclaration":null,"type":"function () payable returns (bool)"},"children":[{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":25,"type":"address","value":"destination"},"id":79,"name":"Identifier","src":"1688:11:0"}],"id":80,"name":"MemberAccess","src":"1688:16:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":27,"type":"bytes memory","value":"data"},"id":81,"name":"Identifier","src":"1705:4:0"}],"id":82,"name":"FunctionCall","src":"1688:22:0"},{"attributes":{"argumentTypes":null,"hexvalue":"63616e206e6f7420696e766f6b652064657374696e6174696f6e2066756e6374696f6e","isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"subdenomination":null,"token":"string","type":"literal_string \"can not invoke destination function\"","value":"can not invoke destination function"},"id":83,"name":"Literal","src":"1712:37:0"}],"id":84,"name":"FunctionCall","src":"1680:70:0"}],"id":85,"name":"ExpressionStatement","src":"1680:70:0"},{"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"tuple()","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_address","typeString":"address"},{"typeIdentifier":"t_address","typeString":"address"}],"overloadedDeclarations":[null],"referencedDeclaration":17,"type":"function (address,address)","value":"MetaTxRelayed"},"id":86,"name":"Identifier","src":"1768:13:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":31,"type":"address","value":"claimedSender"},"id":87,"name":"Identifier","src":"1782:13:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":58,"type":"address","value":"addressFromSig"},"id":88,"name":"Identifier","src":"1797:14:0"}],"id":89,"name":"FunctionCall","src":"1768:44:0"}],"id":90,"name":"EmitStatement","src":"1763:49:0"}],"id":91,"name":"Block","src":"945:875:0"}],"id":92,"name":"FunctionDefinition","src":"792:1028:0"},{"attributes":{"constant":true,"documentation":null,"implemented":true,"isConstructor":false,"modifiers":[null],"name":"getAddressFromData","payable":false,"scope":132,"stateMutability":"pure","superFunction":null,"visibility":"public"},"children":[{"children":[{"attributes":{"constant":false,"name":"b","scope":110,"stateVariable":false,"storageLocation":"default","type":"bytes","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes","type":"bytes"},"id":93,"name":"ElementaryTypeName","src":"2133:5:0"}],"id":94,"name":"VariableDeclaration","src":"2133:7:0"}],"id":95,"name":"ParameterList","src":"2132:9:0"},{"children":[{"attributes":{"constant":false,"name":"a","scope":110,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":96,"name":"ElementaryTypeName","src":"2163:7:0"}],"id":97,"name":"VariableDeclaration","src":"2163:9:0"}],"id":98,"name":"ParameterList","src":"2162:11:0"},{"children":[{"attributes":{"falseBody":null},"children":[{"attributes":{"argumentTypes":null,"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"operator":"<","type":"bool"},"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"member_name":"length","referencedDeclaration":null,"type":"uint256"},"children":[{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":94,"type":"bytes memory","value":"b"},"id":99,"name":"Identifier","src":"2189:1:0"}],"id":100,"name":"MemberAccess","src":"2189:8:0"},{"attributes":{"argumentTypes":null,"hexvalue":"3336","isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"subdenomination":null,"token":"number","type":"int_const 36","value":"36"},"id":101,"name":"Literal","src":"2200:2:0"}],"id":102,"name":"BinaryOperation","src":"2189:13:0"},{"attributes":{"functionReturnParameters":98},"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":true,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"address","type_conversion":true},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_rational_0_by_1","typeString":"int_const 0"}],"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"type":"type(address)","value":"address"},"id":103,"name":"ElementaryTypeNameExpression","src":"2211:7:0"},{"attributes":{"argumentTypes":null,"hexvalue":"30","isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"subdenomination":null,"token":"number","type":"int_const 0","value":"0"},"id":104,"name":"Literal","src":"2219:1:0"}],"id":105,"name":"FunctionCall","src":"2211:10:0"}],"id":106,"name":"Return","src":"2204:17:0"}],"id":107,"name":"IfStatement","src":"2185:36:0"},{"attributes":{"externalReferences":[{"a":{"declaration":97,"isOffset":false,"isSlot":false,"src":"2324:1:0","valueSize":1}},{"b":{"declaration":94,"isOffset":false,"isSlot":false,"src":"2349:1:0","valueSize":1}}],"operations":"{\n    let mask := 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\n    a := and(mask, mload(add(b, 36)))\n}"},"children":[],"id":108,"name":"InlineAssembly","src":"2232:333:0"}],"id":109,"name":"Block","src":"2174:391:0"}],"id":110,"name":"FunctionDefinition","src":"2105:460:0"},{"attributes":{"constant":true,"documentation":null,"implemented":true,"isConstructor":false,"modifiers":[null],"name":"getAddressFromSig","payable":false,"scope":132,"stateMutability":"pure","superFunction":null,"visibility":"public"},"children":[{"children":[{"attributes":{"constant":false,"name":"msgHash","scope":131,"stateVariable":false,"storageLocation":"default","type":"bytes32","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes32","type":"bytes32"},"id":111,"name":"ElementaryTypeName","src":"2832:7:0"}],"id":112,"name":"VariableDeclaration","src":"2832:15:0"},{"attributes":{"constant":false,"name":"sigV","scope":131,"stateVariable":false,"storageLocation":"default","type":"uint8","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"uint8","type":"uint8"},"id":113,"name":"ElementaryTypeName","src":"2858:5:0"}],"id":114,"name":"VariableDeclaration","src":"2858:10:0"},{"attributes":{"constant":false,"name":"sigR","scope":131,"stateVariable":false,"storageLocation":"default","type":"bytes32","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes32","type":"bytes32"},"id":115,"name":"ElementaryTypeName","src":"2879:7:0"}],"id":116,"name":"VariableDeclaration","src":"2879:12:0"},{"attributes":{"constant":false,"name":"sigS","scope":131,"stateVariable":false,"storageLocation":"default","type":"bytes32","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"bytes32","type":"bytes32"},"id":117,"name":"ElementaryTypeName","src":"2902:7:0"}],"id":118,"name":"VariableDeclaration","src":"2902:12:0"}],"id":119,"name":"ParameterList","src":"2821:100:0"},{"children":[{"attributes":{"constant":false,"name":"a","scope":131,"stateVariable":false,"storageLocation":"default","type":"address","value":null,"visibility":"internal"},"children":[{"attributes":{"name":"address","type":"address"},"id":120,"name":"ElementaryTypeName","src":"2943:7:0"}],"id":121,"name":"VariableDeclaration","src":"2943:9:0"}],"id":122,"name":"ParameterList","src":"2942:11:0"},{"children":[{"attributes":{"functionReturnParameters":122},"children":[{"attributes":{"argumentTypes":null,"isConstant":false,"isLValue":false,"isPure":false,"isStructConstructorCall":false,"lValueRequested":false,"names":[null],"type":"address","type_conversion":false},"children":[{"attributes":{"argumentTypes":[{"typeIdentifier":"t_bytes32","typeString":"bytes32"},{"typeIdentifier":"t_uint8","typeString":"uint8"},{"typeIdentifier":"t_bytes32","typeString":"bytes32"},{"typeIdentifier":"t_bytes32","typeString":"bytes32"}],"overloadedDeclarations":[null],"referencedDeclaration":139,"type":"function (bytes32,uint8,bytes32,bytes32) pure returns (address)","value":"ecrecover"},"id":123,"name":"Identifier","src":"2972:9:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":112,"type":"bytes32","value":"msgHash"},"id":124,"name":"Identifier","src":"2982:7:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":114,"type":"uint8","value":"sigV"},"id":125,"name":"Identifier","src":"2991:4:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":116,"type":"bytes32","value":"sigR"},"id":126,"name":"Identifier","src":"2997:4:0"},{"attributes":{"argumentTypes":null,"overloadedDeclarations":[null],"referencedDeclaration":118,"type":"bytes32","value":"sigS"},"id":127,"name":"Identifier","src":"3003:4:0"}],"id":128,"name":"FunctionCall","src":"2972:36:0"}],"id":129,"name":"Return","src":"2965:43:0"}],"id":130,"name":"Block","src":"2954:62:0"}],"id":131,"name":"FunctionDefinition","src":"2795:221:0"}],"id":132,"name":"ContractDefinition","src":"163:2856:0"}],"id":133,"name":"SourceUnit","src":"0:3019:0"}}